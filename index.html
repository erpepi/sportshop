<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tienda Deportiva - Demo</title>
  <!-- Tailwind CDN (para uso rápido) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="description" content="Tienda online de ropa deportiva, zapatillas, chándals y electrónica - demo" />
</head>
<body class="bg-gray-100 text-gray-800">
  <header class="bg-white shadow-md">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <a href="#" class="text-2xl font-bold">TiendaSport</a>
        <nav class="hidden md:flex gap-2">
          <button data-category="all" class="category-btn px-3 py-1 rounded hover:bg-gray-100">Todas</button>
          <button data-category="ropa" class="category-btn px-3 py-1 rounded hover:bg-gray-100">Ropa</button>
          <button data-category="zapatillas" class="category-btn px-3 py-1 rounded hover:bg-gray-100">Zapatillas</button>
          <button data-category="chandals" class="category-btn px-3 py-1 rounded hover:bg-gray-100">Chándals</button>
          <button data-category="electronica" class="category-btn px-3 py-1 rounded hover:bg-gray-100">Electrónica</button>
        </nav>
      </div>
      <div class="flex items-center gap-4">
        <input id="search" type="search" placeholder="Buscar producto" class="hidden md:block border px-3 py-2 rounded w-64" />
        <button id="cart-btn" class="relative bg-indigo-600 text-white px-3 py-2 rounded">Carrito <span id="cart-count" class="ml-2 bg-white text-indigo-700 px-2 py-0.5 rounded">0</span></button>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto p-4">
    <section class="mt-6">
      <h2 class="text-xl font-semibold mb-4">Productos</h2>
      <div id="products" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"></div>
    </section>

    <section class="mt-8">
      <h3 class="text-lg font-semibold mb-2">Pagar con PayPal (Carrito)</h3>
      <div id="paypal-button-container"></div>
      <p class="text-sm text-gray-600 mt-2">* Reemplaza <code>YOUR_PAYPAL_CLIENT_ID</code> en el archivo con tu client-id de PayPal para activar los botones.</p>
    </section>
  </main>

  <!-- Carrito modal -->
  <div id="cart-modal" class="fixed inset-0 bg-black/40 hidden items-center justify-center">
    <div class="bg-white rounded-lg w-11/12 md:w-2/3 lg:w-1/2 p-4">
      <div class="flex justify-between items-center mb-4">
        <h4 class="text-lg font-semibold">Tu carrito</h4>
        <button id="close-cart" class="text-gray-600">Cerrar</button>
      </div>
      <div id="cart-list" class="space-y-3 max-h-64 overflow-auto"></div>
      <div class="mt-4 flex justify-between items-center">
        <div>
          <p class="text-sm">Total:</p>
          <p id="cart-total" class="text-2xl font-bold">€0.00</p>
        </div>
        <div class="flex gap-2">
          <button id="checkout-btn" class="bg-green-600 text-white px-4 py-2 rounded">Pagar</button>
          <button id="clear-cart" class="bg-gray-200 px-4 py-2 rounded">Vaciar</button>
        </div>
      </div>
    </div>
  </div>

  <footer class="mt-12 p-6 text-center text-sm text-gray-600">TiendaSport - Demo · Hecho con ❤️</footer>

  <script>
    // ======= DATOS DE PRODUCTOS =======
    // Ahora las imágenes están en la carpeta "img/" (debes crearla al lado de este archivo y poner tus fotos allí).
    const productsData = [
      { id: 'p1', title: 'Camiseta deportiva', category: 'ropa', price: 19.99, img: 'img/camiseta.jpg' },
      { id: 'p2', title: 'Zapatillas running', category: 'zapatillas', price: 79.90, img: 'img/zapatillas.jpg' },
      { id: 'p3', title: 'Chándal completo', category: 'chandals', price: 49.50, img: 'img/chandal.jpg' },
      { id: 'p4', title: 'Auriculares Bluetooth', category: 'electronica', price: 29.99, img: 'img/auriculares.jpg' },
      { id: 'p5', title: 'Sudadera con capucha', category: 'ropa', price: 34.00, img: 'img/sudadera.jpg' },
      { id: 'p6', title: 'Smartwatch deportivo', category: 'electronica', price: 99.00, img: 'img/smartwatch.jpg' }
    ];

    // ======= LÓGICA DEL CARRITO =======
    let cart = {};

    const productsEl = document.getElementById('products');
    const cartCountEl = document.getElementById('cart-count');

    function renderProducts(filter = 'all', search = ''){
      productsEl.innerHTML = '';
      const list = productsData.filter(p => (filter === 'all' || p.category === filter) && p.title.toLowerCase().includes(search.toLowerCase()));
      for(const p of list){
        const card = document.createElement('article');
        card.className = 'bg-white rounded-lg shadow p-3 flex flex-col';
        card.innerHTML = `
          <img src="${p.img}" alt="${p.title}" class="rounded h-40 w-full object-cover mb-3">
          <h4 class="font-semibold">${p.title}</h4>
          <p class="text-sm text-gray-600">Categoria: ${p.category}</p>
          <div class="mt-auto flex items-center justify-between">
            <div class="text-lg font-bold">€${p.price.toFixed(2)}</div>
            <div class="flex gap-2">
              <button data-id="${p.id}" class="add-btn bg-indigo-600 text-white px-3 py-1 rounded">Añadir</button>
              <button data-id="${p.id}" class="buy-now-btn bg-yellow-400 text-black px-3 py-1 rounded">Comprar</button>
            </div>
          </div>
        `;
        productsEl.appendChild(card);
      }
      attachProductButtons();
    }

    function attachProductButtons(){
      document.querySelectorAll('.add-btn').forEach(b => b.onclick = (e) => { addToCart(e.target.dataset.id); });
      document.querySelectorAll('.buy-now-btn').forEach(b => b.onclick = (e) => { addToCart(e.target.dataset.id); openCart(); });
    }

    function addToCart(id){
      const p = productsData.find(x=>x.id===id);
      if(!cart[id]) cart[id] = { ...p, qty: 0 };
      cart[id].qty += 1;
      updateCartUI();
    }

    function updateCartUI(){
      const qty = Object.values(cart).reduce((s,i)=>s+i.qty,0);
      cartCountEl.textContent = qty;
    }

    // Cart modal
    const cartModal = document.getElementById('cart-modal');
    const cartList = document.getElementById('cart-list');
    const cartTotalEl = document.getElementById('cart-total');

    document.getElementById('cart-btn').onclick = openCart;
    document.getElementById('close-cart').onclick = closeCart;
    document.getElementById('clear-cart').onclick = () => { cart = {}; renderCart(); updateCartUI(); };

    function openCart(){ renderCart(); cartModal.classList.remove('hidden'); cartModal.classList.add('flex'); }
    function closeCart(){ cartModal.classList.remove('flex'); cartModal.classList.add('hidden'); }

    function renderCart(){
      cartList.innerHTML = '';
      let total = 0;
      for(const key of Object.keys(cart)){
        const it = cart[key];
        total += it.price * it.qty;
        const el = document.createElement('div');
        el.className = 'flex items-center justify-between border-b pb-2';
        el.innerHTML = `
          <div>
            <div class="font-semibold">${it.title}</div>
            <div class="text-sm text-gray-600">€${it.price.toFixed(2)} x ${it.qty}</div>
          </div>
          <div class="flex gap-2 items-center">
            <button class="dec-btn px-2 py-1 border rounded" data-id="${it.id}">-</button>
            <button class="inc-btn px-2 py-1 border rounded" data-id="${it.id}">+</button>
            <button class="rm-btn px-2 py-1 border rounded" data-id="${it.id}">x</button>
          </div>
        `;
        cartList.appendChild(el);
      }
      cartTotalEl.textContent = `€${total.toFixed(2)}`;

      document.querySelectorAll('.inc-btn').forEach(b=>b.onclick = (e)=>{ cart[e.target.dataset.id].qty++; renderCart(); updateCartUI(); });
      document.querySelectorAll('.dec-btn').forEach(b=>b.onclick = (e)=>{ const id=e.target.dataset.id; cart[id].qty--; if(cart[id].qty<=0) delete cart[id]; renderCart(); updateCartUI(); });
      document.querySelectorAll('.rm-btn').forEach(b=>b.onclick = (e)=>{ delete cart[e.target.dataset.id]; renderCart(); updateCartUI(); });
    }

    // Category buttons
    document.querySelectorAll('.category-btn').forEach(b=>b.onclick = (e)=>{ document.querySelectorAll('.category-btn').forEach(x=>x.classList.remove('bg-gray-100')); e.target.classList.add('bg-gray-100'); renderProducts(e.target.dataset.category); });
    document.getElementById('search').oninput = (e) => renderProducts(document.querySelector('.category-btn.bg-gray-100')?.dataset.category || 'all', e.target.value);

    // Inicial
    renderProducts();
  </script>

  <!-- PayPal SDK: reemplaza YOUR_PAYPAL_CLIENT_ID por tu client-id -->
  <script src="https://www.paypal.com/sdk/js?client-id=ARAx1kYj3EHirUbD055erXvp4sN1csl0ZMozLgQeO_7D_7QhCZtR7x-Ej0nzd9_lbfTvzs7ofQuvSwhI&currency=EUR"></script>
  <script>
    function getCartTotalValue(){
      return Object.values(cart).reduce((s,i)=>s + i.price * i.qty, 0).toFixed(2);
    }

    paypal.Buttons({
      style: { layout: 'vertical', color: 'blue', shape: 'rect', label: 'paypal' },
      createOrder: function(data, actions) {
        const total = getCartTotalValue();
        if(total <= 0){ alert('El carrito está vacío. Añade productos antes de pagar.'); return; }
        return actions.order.create({
          purchase_units: [{
            amount: { value: String(total) }
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          alert('Pago completado. Gracias, ' + (details.payer.name?.given_name || '') + '!');
          cart = {}; renderCart(); updateCartUI();
        });
      },
      onError: function(err){
        console.error(err); alert('Error en el pago con PayPal. Revisa la consola.');
      }
    }).render('#paypal-button-container');
  </script>

</body>
</html>
